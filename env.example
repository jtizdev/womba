# =====================================
# Womba Configuration Template
# =====================================
# Copy this file to .env and fill in your values
# DO NOT commit .env to version control!

# =====================================
# API Server Configuration
# =====================================
API_HOST=0.0.0.0
API_PORT=8000
ENVIRONMENT=production
SECRET_KEY=change-me-in-production-to-a-long-random-string
LOG_LEVEL=INFO

# =====================================
# AI Provider Keys (at least one required)
# =====================================
# Anthropic (Claude) - Recommended for best results
ANTHROPIC_API_KEY=sk-ant-...

# OpenAI (GPT-4) - Alternative or supplementary
OPENAI_API_KEY=sk-...

# =====================================
# Atlassian Configuration (Required)
# =====================================
# Your Atlassian instance URL (used for both Jira and Confluence)
ATLASSIAN_BASE_URL=https://yourcompany.atlassian.net

# Atlassian user email
ATLASSIAN_EMAIL=your.email@company.com

# Atlassian API token (generate at: https://id.atlassian.com/manage-profile/security/api-tokens)
ATLASSIAN_API_TOKEN=ATATT3xFfGF0...

# =====================================
# Zephyr Scale Configuration (Optional)
# =====================================
# Required only if uploading test cases to Zephyr Scale
ZEPHYR_API_TOKEN=eyJ0eXAiOiJKV1QiLCJh...
ZEPHYR_BASE_URL=https://api.zephyrscale.smartbear.com/v2

# =====================================
# Git Provider Tokens (Optional)
# =====================================
# Required only for automated PR creation
# GitHub
GITHUB_TOKEN=ghp_...

# GitLab
GITLAB_TOKEN=glpat-...

# Bitbucket
BITBUCKET_TOKEN=...

# =====================================
# GitLab Configuration (Optional)
# =====================================
# Required for GitLab Swagger/OpenAPI indexing
# GitLab base URL (default: https://gitlab.com)
GITLAB_BASE_URL=https://gitlab.com

# GitLab group path for service repositories (e.g., plainid/srv)
GITLAB_GROUP_PATH=plainid/srv

# Enable GitLab Swagger indexing
GITLAB_SWAGGER_ENABLED=true

# =====================================
# GitLab MCP Configuration (FALLBACK)
# =====================================
# Womba uses GitLab MCP for semantic code search as a FALLBACK
# when normal Swagger/RAG extraction finds no API endpoints
#
# Authentication: OAuth via mcp-remote (automatic, no tokens needed!)
# - First run: Browser opens for GitLab OAuth login
# - Subsequent runs: Uses cached OAuth credentials (~/.mcp-auth/)
#
# Enable GitLab fallback when no endpoints found via normal extraction
GITLAB_FALLBACK_ENABLED=true

# Optional: MCP server command (default: 'npx' for mcp-remote)
# MCP_GITLAB_SERVER_COMMAND=npx

# Optional: MCP server arguments (default: mcp-remote with GitLab MCP endpoint)
# MCP_GITLAB_SERVER_ARGS=["-y", "mcp-remote", "https://gitlab.com/api/v4/mcp"]

# =====================================
# Figma Integration (Optional)
# =====================================
FIGMA_API_TOKEN=figd_...

# =====================================
# API Documentation (Optional)
# =====================================
# Your company's API documentation URL for context
API_DOCS_URL=https://docs.yourcompany.com/api
API_DOCS_TYPE=auto

# =====================================
# Database Configuration
# =====================================
DATABASE_URL=sqlite:///./womba.db

# =====================================
# Feature Flags
# =====================================
ENABLE_MCP_SERVER=true
ENABLE_CODE_GENERATION=true
ENABLE_FIGMA_INTEGRATION=false

# =====================================
# Rate Limiting
# =====================================
MAX_REQUESTS_PER_MINUTE=60

# =====================================
# AI Model Configuration
# =====================================
# Default AI model (Claude Sonnet recommended)
DEFAULT_AI_MODEL=claude-3-5-sonnet-20241022

# AI Model for test generation (use gpt-4o-2024-08-06 for JSON schema + high tokens)
# Recommended: gpt-4o-2024-08-06 (supports 16K output tokens + JSON schema)
# Alternative: gpt-4-turbo (max 4096 tokens), gpt-4o-mini (max 16K tokens)
AI_MODEL=gpt-4o-2024-08-06

# Temperature: 0.0-1.0 (higher = more creative, lower = more deterministic)
# CRITICAL: Keep at 0.2 for test generation (more deterministic, better instruction following)
TEMPERATURE=0.2

# Maximum tokens for AI responses (gpt-4o-2024-08-06 supports up to 16384)
MAX_TOKENS=10000

# =====================================
# RAG (Retrieval-Augmented Generation) Configuration
# =====================================
# Enable RAG for context-aware test generation
ENABLE_RAG=true

# ChromaDB storage path (persistent volume in Docker)
RAG_COLLECTION_PATH=/app/data/chroma

# OpenAI embedding model for semantic search
EMBEDDING_MODEL=text-embedding-3-small

# Number of similar items to retrieve from RAG
# These are starting defaults - adjust based on similarity scores and token budget
RAG_TOP_K_TESTS=5
RAG_TOP_K_DOCS=10
RAG_TOP_K_STORIES=10
RAG_TOP_K_EXISTING=20
RAG_TOP_K_SWAGGER=5

# Minimum similarity threshold (0.0-1.0) to filter low-quality results
# Documents below this threshold will be excluded from retrieval
# Recommended: 0.5 (50% similarity) - adjust based on your data quality
RAG_MIN_SIMILARITY=0.5

# Automatically index test plans after generation
RAG_AUTO_INDEX=true

# Minimum hours between automatic full RAG refresh (leave empty for manual only)
# RAG_REFRESH_HOURS=24

# =====================================
# PlainID Documentation Indexing (Optional)
# =====================================
# Enable indexing of PlainID external documentation
PLAINID_DOC_INDEX_ENABLED=true

# PlainID Developer Portal URLs to crawl
# PLAINID_DOC_BASE_URL=https://docs.plainid.io
# PLAINID_DOC_URLS=["https://docs.plainid.io/apidocs/authorization-apis","https://docs.plainid.io/apidocs/policy-management-apis"]

# Crawling limits
PLAINID_DOC_MAX_PAGES=200
PLAINID_DOC_MAX_DEPTH=5
PLAINID_DOC_REQUEST_DELAY=0.3
PLAINID_DOC_PROJECT_KEY=PLAT

