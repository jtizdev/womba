{
  "story": {
    "key": "PLAT-15474",
    "summary": "(1.1.4.1) - Tenant IDP configuration - Add Scopes",
    "description": "<jira.resources.PropertyHolder object at 0x1037715e0>",
    "issue_type": "Story",
    "status": "Ready for deployment",
    "priority": "High",
    "assignee": "Igor Langer",
    "reporter": "Tal Agam",
    "created": "2025-06-04 15:58:33.888000+03:00",
    "updated": "2025-11-03 10:48:01.943000+02:00",
    "labels": [
      "Generic",
      "Mgmt-Q3-25",
      "Permissions"
    ],
    "components": [
      "PAP"
    ],
    "acceptance_criteria": "2|i0542p:l",
    "linked_issues": [
      "PLAT-16618"
    ],
    "attachments": [],
    "custom_fields": {
      "customfield_10100": "2|i0542p:l",
      "customfield_10102": "PLAT-1605",
      "customfield_10200": [
        "Not Deployed"
      ],
      "customfield_10401": [],
      "customfield_10403": [],
      "customfield_10416": [
        "Test"
      ],
      "customfield_10500": "{repository={count=3, dataType=repository}, json={\"cachedValue\":{\"errors\":[],\"summary\":{\"repository\":{\"overall\":{\"count\":3,\"lastUpdated\":\"2025-10-28T15:15:15.000+0200\",\"dataType\":\"repository\"},\"byInstanceType\":{\"GitLab\":{\"count\":3,\"name\":\"GitLab\"}}}}},\"isStale\":true}}",
      "customfield_10509": "2025-10-09",
      "customfield_10512": "2025-09-28T17:22:34.188+0300",
      "customfield_10525": "Low",
      "customfield_10590": "Functional",
      "customfield_10597": 0.0,
      "customfield_10598": 0.0,
      "customfield_10610": "NO",
      "customfield_10641": "Low",
      "customfield_10644": "Low",
      "customfield_10645": [],
      "customfield_10650": "Alexander Galperin",
      "customfield_10689": [
        "Yes"
      ],
      "customfield_10701": [
        "Yes"
      ],
      "customfield_10705": [
        "No"
      ],
      "customfield_10712": [
        "BE",
        "FE"
      ],
      "customfield_10727": [
        "Cisco",
        "Vonage"
      ],
      "customfield_10735": [
        "No"
      ],
      "customfield_10743": [
        "No"
      ],
      "customfield_10776": "Management",
      "customfield_10784": "Sharon",
      "customfield_10795": "PS"
    }
  },
  "test_cases": [
    {
      "id": null,
      "title": "Verify scopes can be added to Tenant IDP configuration successfully",
      "description": "Ensure that when valid scope data is sent to the Tenant IDP configuration, the API accepts it and returns a success response.",
      "preconditions": "User has valid Management API credentials. The Tenant IDP configuration is set up but currently has no scopes defined.",
      "steps": [
        {
          "step_number": 1,
          "action": "Send POST request to /api/tenant/{tenant_id}/idp/scopes with body {'scopes': ['read:users', 'write:users']}'",
          "expected_result": "API returns status 200 OK with response body confirming added scopes.",
          "test_data": "{ 'scopes': ['read:users', 'write:users'] }"
        },
        {
          "step_number": 2,
          "action": "GET /api/tenant/{tenant_id}/idp/scopes",
          "expected_result": "API returns the list of scopes including 'read:users' and 'write:users'.",
          "test_data": null
        }
      ],
      "expected_result": "Scopes are successfully added and retrievable in the Tenant IDP configuration.",
      "priority": "high",
      "test_type": "functional",
      "tags": [
        "tenant-idp",
        "scope-management",
        "happy-path"
      ],
      "estimated_time": null,
      "automation_candidate": true,
      "risk_level": "high",
      "related_existing_tests": []
    },
    {
      "id": null,
      "title": "Verify appropriate error message is returned when adding duplicate scopes",
      "description": "Test that the API correctly handles attempts to add duplicate scopes to the Tenant IDP configuration.",
      "preconditions": "User has valid Management API credentials. The Tenant IDP configuration already contains the scope 'read:users'.",
      "steps": [
        {
          "step_number": 1,
          "action": "Send POST request to /api/tenant/{tenant_id}/idp/scopes with body {'scopes': ['read:users']}'",
          "expected_result": "API returns status 409 Conflict with error message 'Scope already exists.'",
          "test_data": "{ 'scopes': ['read:users'] }"
        }
      ],
      "expected_result": "System prevents duplicate scopes and provides a clear error message to the user.",
      "priority": "high",
      "test_type": "negative",
      "tags": [
        "tenant-idp",
        "scope-management",
        "error-handling"
      ],
      "estimated_time": null,
      "automation_candidate": true,
      "risk_level": "medium",
      "related_existing_tests": []
    },
    {
      "id": null,
      "title": "Verify API returns 400 error when adding scopes without valid tenant_id",
      "description": "Ensure the API properly validates the tenant_id parameter when attempting to add scopes.",
      "preconditions": "User has valid Management API credentials.",
      "steps": [
        {
          "step_number": 1,
          "action": "Send POST request to /api/tenant/invalid_id/idp/scopes with body {'scopes': ['read:users']}'",
          "expected_result": "API returns status 400 Bad Request with error message 'Invalid tenant_id.'",
          "test_data": "{ 'scopes': ['read:users'] }"
        }
      ],
      "expected_result": "API validates tenant_id and returns the appropriate error message.",
      "priority": "high",
      "test_type": "negative",
      "tags": [
        "tenant-idp",
        "scope-management",
        "error-handling"
      ],
      "estimated_time": null,
      "automation_candidate": true,
      "risk_level": "medium",
      "related_existing_tests": []
    },
    {
      "id": null,
      "title": "Verify exporting of Tenant IDP configuration includes new scopes",
      "description": "Validate that when exporting the Tenant IDP configuration, the newly added scopes are included in the export.",
      "preconditions": "User has valid Management API credentials. The Tenant IDP configuration has scopes 'read:users' and 'write:users' defined.",
      "steps": [
        {
          "step_number": 1,
          "action": "GET /api/tenant/{tenant_id}/idp/export",
          "expected_result": "API returns exported configuration including 'scopes': ['read:users', 'write:users'].",
          "test_data": null
        }
      ],
      "expected_result": "Exported configuration accurately reflects current Tenant IDP setup including scopes.",
      "priority": "high",
      "test_type": "integration",
      "tags": [
        "tenant-idp",
        "scope-management",
        "export-import"
      ],
      "estimated_time": null,
      "automation_candidate": true,
      "risk_level": "high",
      "related_existing_tests": []
    },
    {
      "id": null,
      "title": "Verify importing of Tenant IDP configuration correctly adds new scopes",
      "description": "Ensure that when importing a Tenant IDP configuration, the API correctly adds the specified scopes.",
      "preconditions": "User has valid Management API credentials. The Tenant IDP configuration has no scopes defined.",
      "steps": [
        {
          "step_number": 1,
          "action": "POST /api/tenant/{tenant_id}/idp/import with body {'scopes': ['read:users', 'write:users']}'",
          "expected_result": "API returns status 200 OK indicating scopes were added successfully.",
          "test_data": "{ 'scopes': ['read:users', 'write:users'] }"
        },
        {
          "step_number": 2,
          "action": "GET /api/tenant/{tenant_id}/idp/scopes",
          "expected_result": "API returns the list of scopes including 'read:users' and 'write:users'.",
          "test_data": null
        }
      ],
      "expected_result": "Imported configuration accurately reflects the new scopes added to the Tenant IDP.",
      "priority": "high",
      "test_type": "integration",
      "tags": [
        "tenant-idp",
        "scope-management",
        "export-import"
      ],
      "estimated_time": null,
      "automation_candidate": true,
      "risk_level": "high",
      "related_existing_tests": []
    },
    {
      "id": null,
      "title": "Confirm API returns 404 on importing non-existent Tenant IDP configuration",
      "description": "Validate that the API returns a 404 error when attempting to import a configuration that does not exist.",
      "preconditions": "User has valid Management API credentials.",
      "steps": [
        {
          "step_number": 1,
          "action": "POST /api/tenant/non_existent_id/idp/import with body {'scopes': ['read:users']}'",
          "expected_result": "API returns status 404 Not Found with error message 'Tenant IDP configuration not found.'",
          "test_data": "{ 'scopes': ['read:users'] }"
        }
      ],
      "expected_result": "API provides appropriate feedback when a non-existent IDP configuration is referenced.",
      "priority": "high",
      "test_type": "negative",
      "tags": [
        "tenant-idp",
        "scope-management",
        "error-handling"
      ],
      "estimated_time": null,
      "automation_candidate": true,
      "risk_level": "medium",
      "related_existing_tests": []
    }
  ],
  "metadata": {
    "generated_at": "2025-11-03 09:19:12.389651",
    "ai_model": "gpt-4o-mini",
    "source_story_key": "PLAT-15474",
    "total_test_cases": 6,
    "edge_case_count": 0,
    "integration_test_count": 2,
    "confidence_score": 0.9
  },
  "summary": "These tests verify the functionality and integration of the Tenant IDP configuration featuring the addition of scopes, ensuring successful API interactions and error handling.",
  "coverage_analysis": null,
  "risk_assessment": null,
  "regression_risks": null,
  "side_effects": null,
  "dependencies": [],
  "estimated_execution_time": null,
  "suggested_folder": "Tenant Management/IDP Configuration"
}